#include "StdTypes.h"
#include "RGB_Data.h"
#include "RGBA.h"
/***********************************/
#include "MemMap.h"
#include "LCD_Interface.h"
// #define F_CPU 8000000
// #include "util\delay.h"
/***********************************/
RGB_data_type Color_Correct[LEDS_COLLOR_SIZE] = {
	{253, 18, 0},
	{253, 31, 1},
	{235, 7, 6},
	{255, 10, 14},
	{255, 48, 1},
	{53, 255, 8},
	{9, 89, 255},
	{255, 13, 22},
	{57, 255, 26},
	{50, 255, 17},
	{10, 108, 255},
	{254, 65, 2},
	{255, 16, 32},
	{12, 128, 255},
	{27, 90, 255},
	{60, 238, 255},
	{67, 255, 8},
	{255, 20, 43},
	{253, 86, 2},
	{14, 177, 254},
	{255, 25, 56},
	{46, 89, 255},
	{15, 207, 255},
	{12, 255, 16},
	{254, 111, 3},
	{68, 255, 154},
	{255, 65, 28},
	{15, 239, 255},
	{255, 30, 71},
	{80, 255, 7},
	{65, 90, 255},
	{17, 255, 234},
	{13, 255, 26},
	{38, 255, 152},
	{86, 90, 255},
	{16, 255, 202},
	{255, 154, 4},
	{255, 36, 90},
	{108, 90, 255},
	{16, 255, 174},
	{13, 255, 37},
	{94, 255, 7},
	{255, 174, 5},
	{131, 91, 254},
	{15, 254, 149},
	{13, 255, 49},
	{156, 92, 255},
	{254, 194, 5},
	{255, 177, 3},
	{108, 255, 7},
	{183, 92, 255},
	{254, 44, 113},
	{255, 215, 6},
	{13, 253, 61},
	{122, 255, 7},
	{232, 89, 244},
	{255, 221, 57},
	{14, 255, 109},
	{255, 228, 12},
	{199, 249, 161},
	{255, 237, 6},
	{246, 84, 228},
	{14, 255, 76},
	{136, 255, 7},
	{253, 54, 142},
	{251, 255, 7},
	{14, 254, 91},
	{251, 67, 179},
	{150, 255, 7},
	{218, 255, 10},
	{231, 255, 7},
	{164, 255, 7},
	{179, 255, 7},
	{212, 255, 7},
	{77, 255, 108},
	{195, 255, 7},
	{255, 247, 37},
	{196, 255, 85}
};

u16 incomingData_incoded[LEDS_COLLOR_SIZE] = { 
	7083,
	7809,
	8110,
	8810,
	8931,
	8940,
	9147,
	9360,
	9383,
	9383,
	9510,
	9690,
	9860,
	9873,
	9897,
	9897,
	10213,
	10335,
	10350,
	10566,
	10785,
	10836,
	10929,
	10965,
	11010,
	11041,
	11167,
	11247,
	11285,
	11378,
	11478,
	11688,
	11815,
	11837,
	11985,
	12084,
	12125,
	12148,
	12378,
	12513,
	12515,
	12541,
	12679,
	12750,
	12975,
	13115,
	13122,
	13200,
	13247,
	13299,
	13407,
	13515,
	13696,
	13715,
	13920,
	14004,
	14039,
	14097,
	14178,
	14187,
	14225,
	14262,
	14265,
	14435,
	14668,
	14754,
	14757,
	14820,
	14896,
	15212,
	15258,
	15303,
	15710,
	15787,
	15888,
	16117,
	18404,
	21675
};

s8 BinarySearch(u16 data)
{
	u16 left  = 0 ;
	u16 right  = LEDS_COLLOR_SIZE-1 ;
	u16 mid = 0 ;
	while(right >=left)
	{
		if (left== 0&& right==0){
			mid = 0 ;
		}else
		mid = (left + right) / 2;
		
		if (incomingData_incoded[mid]==data)
		{
			return mid ;
		}
		else if (incomingData_incoded[mid]< data)
		{
			left = mid+1 ;
			if (mid==0){
				return -1 ;
			}
		}
		else if (incomingData_incoded[mid] > data)
		{
			right =mid-1 ;
			if (mid==0){
				return -1 ;
			}
		}
	}
	return -1 ;
}
void ColorCheck(RGB_data_type *colors ){
	u16 datacheck = INCODE(colors->Red ,colors->Green ,colors->blue) ;
	s8 check_index = BinarySearch(datacheck) ;
	if (check_index ==-1) {

		return ;
		} else if (check_index >=0 && check_index<LEDS_COLLOR_SIZE) {
		*colors = Color_Correct[check_index] ;
		
	}
}
void RGBA_Rannable(){

	RGB_data_type temp ;
	u8 i = 0 ;
	/************************/ //testing
	TCNT1 = 0 ;
	u32 data = 0 ;
	/************************/
	for( i = 0 ; i < LEDS_COLLOR_SIZE ; i++  ){
		RGB_DATA_Getter(i ,&temp ) ;
		ColorCheck( &temp ) ;
// Rgb (id , red , green,blue) ; 
	
	}
	//////////////////////////////////////////////////////////////testing
	data = TCNT1 ;
	LCD_SetCursor(0,0) ;
	LCD_WriteNumber(data);
	//////////////////////////////////////////////////////////////
}
